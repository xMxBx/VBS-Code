, Created by Marti B --- mXb


' Constants for logging and progress tracking
Const ForAppending = 8
Const LogFile = "C:\VulnerabilityScanLog.txt"

' Function to log results
Sub LogResult(message)
    Set objFSO = CreateObject("Scripting.FileSystemObject")
    If Not objFSO.FileExists(LogFile) Then
        Set objLogFile = objFSO.CreateTextFile(LogFile)
    Else
        Set objLogFile = objFSO.OpenTextFile(LogFile, ForAppending, True)
    End If
    objLogFile.WriteLine(Now & " - " & message)
    objLogFile.Close
End Sub

' Function to update the progress
Sub ShowProgress(progress)
    progressMessage = "Test in Progress: " & progress & "% completed."
    WScript.Echo progressMessage
End Sub

' Initialize WMI service
Set objWMIService = GetObject("winmgmts:\\.\root\cimv2")
On Error Resume Next ' Error handling to continue checks even if one fails

' Total number of steps (can be changed based on the number of checks you perform)
totalSteps = 6
stepCounter = 0


' 1/////Check for Windows Updates (More detailed)



stepCounter = stepCounter + 1
ShowProgress((stepCounter / totalSteps) * 100)

Set colUpdates = objWMIService.ExecQuery("Select * from Win32_QuickFixEngineering")
If colUpdates.Count = 0 Then
    LogResult "No Windows updates found. Your system may be vulnerable due to missing critical updates."
    MsgBox "No updates found. Your system may be vulnerable.", vbExclamation, "Update Check"
Else
    LogResult "Windows updates are installed."
    MsgBox "Windows updates are installed.", vbInformation, "Update Check"
End If


' 2///// Check for Critical Security Services

stepCounter = stepCounter + 1
ShowProgress((stepCounter / totalSteps) * 100)

' Checking if important security services are running
Set colFirewall = objWMIService.ExecQuery("Select * from Win32_Service where Name='MpsSvc'")
If colFirewall.Count = 0 Or colFirewall(0).State <> "Running" Then
    LogResult "Windows Firewall is not running. System may be vulnerable."
    MsgBox "Windows Firewall is not running. System may be vulnerable.", vbExclamation, "Firewall Check"
Else
    LogResult "Windows Firewall is running."
    MsgBox "Windows Firewall is running.", vbInformation, "Firewall Check"
End If



 3/////// Check for Vulnerable Software (e.g., outdated Java, Flash, etc.)

stepCounter = stepCounter + 1
ShowProgress((stepCounter / totalSteps) * 100)

Set colSoftware = objWMIService.ExecQuery("Select * from Win32_Product where (Name LIKE 'Java%' OR Name LIKE 'Flash%')")
If colSoftware.Count > 0 Then
    For Each software In colSoftware
        LogResult "Vulnerable software detected: " & software.Name & " Version: " & software.Version
    Next
    MsgBox "Vulnerable software detected (e.g., Java, Flash).", vbExclamation, "Vulnerable Software"
Else
    LogResult "No known vulnerable software (Java, Flash) found."
    MsgBox "No vulnerable software (Java, Flash) found.", vbInformation, "Vulnerable Software"
End If



' 4///// Check for Open Network Ports (More ports and external checks)

stepCounter = stepCounter + 1
ShowProgress((stepCounter / totalSteps) * 100)

' Example: Checking if RDP (port 3389) and SMB
